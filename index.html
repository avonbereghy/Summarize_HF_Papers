<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HuggingFace Papers Daily Summary</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .intro {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .intro h1 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        .intro p {
            color: #666;
            font-size: 1.1em;
            max-width: 600px;
            margin: 0 auto;
        }

        .calendar-container {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
        }

        .calendar-section {
            flex: 1;
            min-width: 300px;
        }

        .calendar {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }

        .calendar-header h2 {
            font-size: 1.3em;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav button {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .calendar-nav button:hover {
            background: rgba(255,255,255,0.3);
        }

        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 10px;
        }

        .calendar-weekday {
            text-align: center;
            font-weight: bold;
            color: #666;
            font-size: 0.9em;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            font-weight: 500;
        }

        .calendar-day:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .calendar-day.other-month {
            color: #ccc;
            background: #f0f0f0;
        }

        .calendar-day.has-papers {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
        }

        .calendar-day.has-papers::after {
            content: attr(data-count);
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 0.7em;
            background: rgba(255,255,255,0.3);
            padding: 2px 5px;
            border-radius: 3px;
        }

        .calendar-day.selected {
            background: #764ba2;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(118,75,162,0.3);
        }

        .summary-section {
            flex: 1.5;
            min-width: 400px;
        }

        .summary-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .summary-placeholder {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .summary-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .summary-header h3 {
            color: #764ba2;
            margin-bottom: 5px;
        }

        .paper-list {
            list-style: none;
        }

        .paper-item {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .paper-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .paper-item h4 {
            color: #764ba2;
            margin: 10px 0;
        }

        .paper-id {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .paper-id a {
            color: #667eea;
            text-decoration: none;
        }

        .paper-id a:hover {
            text-decoration: underline;
        }

        .paper-authors {
            font-size: 0.9em;
            color: #888;
            margin: 5px 0;
            font-style: italic;
        }

        .paper-summary {
            margin-top: 10px;
            line-height: 1.6;
            color: #555;
        }

        .paper-detail {
            display: none;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .paper-detail.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        .paper-detail h2 {
            color: #764ba2;
            margin-bottom: 15px;
        }

        .paper-detail section {
            margin-bottom: 20px;
        }

        .paper-detail h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .paper-detail p, .paper-detail li {
            line-height: 1.8;
            color: #555;
        }

        .paper-detail ul {
            margin-left: 20px;
        }

        .paper-detail a {
            color: #764ba2;
            text-decoration: none;
        }

        .paper-detail a:hover {
            text-decoration: underline;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 768px) {
            .calendar-container {
                flex-direction: column;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="intro">
            <h1>HuggingFace Papers Daily</h1>
            <p>Welcome! I'm passionate about machine learning and AI research. Here you'll find daily summaries of the latest papers from HuggingFace. Click on any highlighted date in the calendar to explore the papers published that day.</p>
        </div>

        <div class="calendar-container">
            <div class="calendar-section">
                <div class="calendar">
                    <div class="calendar-header">
                        <button class="calendar-nav" onclick="previousMonth()">←</button>
                        <h2 id="currentMonth">August 2025</h2>
                        <button class="calendar-nav" onclick="nextMonth()">→</button>
                    </div>
                    <div class="calendar-weekdays">
                        <div class="calendar-weekday">Sun</div>
                        <div class="calendar-weekday">Mon</div>
                        <div class="calendar-weekday">Tue</div>
                        <div class="calendar-weekday">Wed</div>
                        <div class="calendar-weekday">Thu</div>
                        <div class="calendar-weekday">Fri</div>
                        <div class="calendar-weekday">Sat</div>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be generated here -->
                    </div>
                </div>
            </div>

            <div class="summary-section">
                <div class="summary-container" id="summaryContainer">
                    <div class="summary-placeholder">
                        <h3>Select a date to view papers</h3>
                        <p>Click on highlighted dates in the calendar to see the paper summaries for that day.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Paper data structure - will be loaded from data.json
        let papersData = {};
        let currentDate = new Date();
        let selectedDate = null;

        // Initialize calendar
        async function init() {
            await loadPapersData();
            renderCalendar();
        }

        // Load papers data from data.json
        async function loadPapersData() {
            try {
                const response = await fetch('data.json');
                if (response.ok) {
                    const data = await response.json();
                    papersData = data.papers || {};
                    console.log(`Loaded data for ${Object.keys(papersData).length} dates`);
                } else {
                    console.error('Failed to load data.json');
                    papersData = {};
                }
            } catch (error) {
                console.error('Error loading data.json:', error);
                papersData = {};
            }
        }

        // Get papers for a given date
        function getPapersForDate(dateStr) {
            return papersData[dateStr] || [];
        }

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Update month header
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
            
            // Clear calendar grid
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = firstDay - 1; i >= 0; i--) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = daysInPrevMonth - i;
                grid.appendChild(dayElement);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                // Format date string as YYYY-MM-DD
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                // Check if this date has papers
                const papers = getPapersForDate(dateStr);
                if (papers.length > 0) {
                    dayElement.className += ' has-papers';
                    dayElement.setAttribute('data-count', papers.length);
                    dayElement.onclick = () => selectDate(dateStr);
                }
                
                // Highlight selected date
                if (selectedDate === dateStr) {
                    dayElement.className += ' selected';
                }
                
                grid.appendChild(dayElement);
            }
            
            // Add empty cells for remaining week
            const totalCells = grid.children.length;
            const remainingCells = 42 - totalCells; // 6 weeks * 7 days
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                dayElement.textContent = day;
                grid.appendChild(dayElement);
            }
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        async function selectDate(dateStr) {
            selectedDate = dateStr;
            renderCalendar();
            
            const container = document.getElementById('summaryContainer');
            container.innerHTML = '<div class="loading">Loading papers</div>';
            
            // Display papers for the selected date
            await displayPapers(dateStr);
        }

        async function displayPapers(dateStr) {
            const container = document.getElementById('summaryContainer');
            const papers = getPapersForDate(dateStr);
            
            if (papers.length === 0) {
                container.innerHTML = '<div class="summary-placeholder"><h3>No papers available</h3><p>No papers found for this date.</p></div>';
                return;
            }
            
            const foundPapers = [];
            
            // Load summary files for each paper
            for (const paper of papers) {
                try {
                    const summaryPath = `${paper.path}/summary.md`;
                    const response = await fetch(summaryPath);
                    if (response.ok) {
                        const summaryText = await response.text();
                        if (summaryText && summaryText.trim() !== '') {
                            foundPapers.push({ 
                                id: paper.id, 
                                summaryText, 
                                path: paper.path 
                            });
                        }
                    }
                } catch (error) {
                    console.error(`Error loading paper ${paper.id}:`, error);
                }
            }
            
            if (foundPapers.length === 0) {
                container.innerHTML = '<div class="summary-placeholder"><h3>Error loading papers</h3><p>Could not load paper summaries for this date.</p></div>';
                return;
            }
            
            // Create summary content
            let html = `
                <div class="summary-content">
                    <div class="summary-header">
                        <h3>Papers for ${dateStr}</h3>
                        <p>${foundPapers.length} papers available</p>
                    </div>
                    <ul class="paper-list">
            `;
            
            for (const paper of foundPapers) {
                try {
                    // Extract title from markdown
                    const titleMatch = paper.summaryText.match(/^# (.+)$/m);
                    const title = titleMatch ? titleMatch[1] : `Paper ${paper.id}`;
                    
                    // Extract Paper ID from markdown
                    const paperIdMatch = paper.summaryText.match(/\*\*Paper ID:\*\* (.+)$/m);
                    const displayId = paperIdMatch ? paperIdMatch[1] : paper.id;
                    
                    // Extract authors from the bottom
                    const authorsMatch = paper.summaryText.match(/\*\*Authors:\*\* (.+)$/m);
                    const authors = authorsMatch ? authorsMatch[1] : 'Authors not available';
                    
                    // Extract executive summary
                    const execSummaryMatch = paper.summaryText.match(/## Executive Summary\s+([\s\S]*?)(?=\n##|$)/);
                    const execSummary = execSummaryMatch ? execSummaryMatch[1].trim() : 'Summary not available';
                    
                    // Extract URL
                    const urlMatch = paper.summaryText.match(/\*\*URL:\*\* (.+)$/m);
                    const paperUrl = urlMatch ? urlMatch[1] : `https://arxiv.org/abs/${displayId}`;
                    
                    html += `
                        <li class="paper-item" onclick="togglePaperDetail('${paper.id}')">
                            <div class="paper-id">Paper #${displayId} | <a href="${paperUrl}" target="_blank" onclick="event.stopPropagation();">View on ArXiv</a></div>
                            <h4>${title}</h4>
                            <div class="paper-authors">${authors}</div>
                            <div class="paper-summary">${execSummary}</div>
                        </li>
                        <div class="paper-detail" id="detail-${paper.id}">
                            <div style="white-space: pre-wrap; font-family: inherit;">${paper.summaryText}</div>
                        </div>
                    `;
                } catch (error) {
                    console.error(`Error processing paper ${paper.id}:`, error);
                    html += `
                        <li class="paper-item">
                            <div class="paper-id">Paper #${paper.id}</div>
                            <h4>Error processing paper</h4>
                            <div class="paper-summary">Unable to process paper summary</div>
                        </li>
                    `;
                }
            }
            
            html += `
                    </ul>
                </div>
            `;
            
            container.innerHTML = html;
        }

        function togglePaperDetail(paperId) {
            const detail = document.getElementById(`detail-${paperId}`);
            const allDetails = document.querySelectorAll('.paper-detail');
            
            allDetails.forEach(d => {
                if (d !== detail) {
                    d.classList.remove('active');
                }
            });
            
            detail.classList.toggle('active');
        }

        // Initialize on page load
        init();
    </script>
</body>
</html>